CONST
   ENCODER_A1 = P11
   ENCODER_C4 = P16
VAR
   long rawBits
   long altitude
   long myStack[16]

PUB Start
   Initialize
   cognew(PollLoop, @myStack)

PUB Initialize
   dira[ENCODER_A1 .. ENCODER_C4] := 0

PUB GetAltitude : res
   res := altitude

PUB GetRawBits : res
   res := rawBits    

PUB Poll
   rawBits := ina[ENCODER_A1 .. ENCODER_C4]
   altitude := DecodeBits(rawBits)

PUB PollLoop
   repeat
       Poll

PUB DecodeBits(

GREYCODE
       byte %000000001 '-1200
       byte %000000011 '-1100
       byte %000000010 '-1000
       byte %000000110 '-900
       byte %000000100 '-800
       byte %000001100 '-700
       byte %000001110 '-600
       byte %000001010 '-500
       byte %000001011 '-400
       byte %000001001 '-300
       byte %000011001 '-200
       byte %000011011 '-100
       byte %000011010 '0
       byte %000011110 '100
       byte %000011100 '200
       byte %000010100 '300
       byte %000010110 '400
       byte %000010010 '500
       byte %000010011 '600
       byte %000010001 '700
       byte %000110001 '800
       byte %000110011 '900
       byte %000110010 '1000
       byte %000110110 '1100
       byte %000110100 '1200
       byte %000111100 '1300
       byte %000111110 '1400
       byte %000111010 '1500
       byte %000111011 '1600
       byte %000111001 '1700
       byte %000101001 '1800
       byte %000101011 '1900
       byte %000101010 '2000
       byte %000101110 '2100
       byte %000101100 '2200
       byte %000100100 '2300
       byte %000100110 '2400
       byte %000100010 '2500
       byte %000100011 '2600
       byte %000100001 '2700
       byte %001100001 '2800
       byte %001100011 '2900
       byte %001100010 '3000
       byte %001100110 '3100
       byte %001100100 '3200
       byte %001101100 '3300
       byte %001101110 '3400
       byte %001101010 '3500
       byte %001101011 '3600
       byte %001101001 '3700
       byte %001111001 '3800
       byte %001111011 '3900
       byte %001111010 '4000
       byte %001111110 '4100
       byte %001111100 '4200
       byte %001110100 '4300
       byte %001110110 '4400
       byte %001110010 '4500
       byte %001110011 '4600
       byte %001110001 '4700
       byte %001010001 '4800
       byte %001010011 '4900
       byte %001010010 '5000
       byte %001010110 '5100
       byte %001010100 '5200
       byte %001011100 '5300
       byte %001011110 '5400
       byte %001011010 '5500
       byte %001011011 '5600
       byte %001011001 '5700
       byte %001001001 '5800
       byte %001001011 '5900
       byte %001001010 '6000
       byte %001001110 '6100
       byte %001001100 '6200
       byte %001000100 '6300
       byte %001000110 '6400
       byte %001000010 '6500
       byte %001000011 '6600
       byte %001000001 '6700
       byte %011000001 '6800
       byte %011000011 '6900
       byte %011000010 '7000
       byte %011000110 '7100
       byte %011000100 '7200
       byte %011001100 '7300
       byte %011001110 '7400
       byte %011001010 '7500
       byte %011001011 '7600
       byte %011001001 '7700
       byte %011011001 '7800
       byte %011011011 '7900
       byte %011011010 '8000
       byte %011011110 '8100
       byte %011011100 '8200
       byte %011010100 '8300
       byte %011010110 '8400
       byte %011010010 '8500
       byte %011010011 '8600
       byte %011010001 '8700
       byte %011110001 '8800
       byte %011110011 '8900
       byte %011110010 '9000
       byte %011110110 '9100
       byte %011110100 '9200
       byte %011111100 '9300
       byte %011111110 '9400
       byte %011111010 '9500
       byte %011111011 '9600
       byte %011111001 '9700
       byte %011101001 '9800
       byte %011101011 '9900
       byte %011101010 '10000
       byte %011101110 '10100
       byte %011101100 '10200
       byte %011100100 '10300
       byte %011100110 '10400
       byte %011100010 '10500
       byte %011100011 '10600
       byte %011100001 '10700
       byte %010100001 '10800
       byte %010100011 '10900
       byte %010100010 '11000
       byte %010100110 '11100
       byte %010100100 '11200
       byte %010101100 '11300
       byte %010101110 '11400
       byte %010101010 '11500
       byte %010101011 '11600
       byte %010101001 '11700
       byte %010111001 '11800
       byte %010111011 '11900
       byte %010111010 '12000
       byte %010111110 '12100
       byte %010111100 '12200
       byte %010110100 '12300
       byte %010110110 '12400
       byte %010110010 '12500
       byte %010110011 '12600
       byte %010110001 '12700
       byte %010010001 '12800
       byte %010010011 '12900
       byte %010010010 '13000
       byte %010010110 '13100
       byte %010010100 '13200
       byte %010011100 '13300
       byte %010011110 '13400
       byte %010011010 '13500
       byte %010011011 '13600
       byte %010011001 '13700
       byte %010001001 '13800
       byte %010001011 '13900
       byte %010001010 '14000
       byte %010001110 '14100
       byte %010001100 '14200
       byte %010000100 '14300
       byte %010000110 '14400
       byte %010000010 '14500
       byte %010000011 '14600
       byte %010000001 '14700
       byte %110000001 '14800
       byte %110000011 '14900
       byte %110000010 '15000
       byte %110000110 '15100
       byte %110000100 '15200
       byte %110001100 '15300
       byte %110001110 '15400
       byte %110001010 '15500
       byte %110001011 '15600
       byte %110001001 '15700
       byte %110011001 '15800
       byte %110011011 '15900
       byte %110011010 '16000
       byte %110011110 '16100
       byte %110011100 '16200
       byte %110010100 '16300
       byte %110010110 '16400
       byte %110010010 '16500
       byte %110010011 '16600
       byte %110010001 '16700
       byte %110110001 '16800
       byte %110110011 '16900
       byte %110110010 '17000
       byte %110110110 '17100
       byte %110110100 '17200
       byte %110111100 '17300
       byte %110111110 '17400
       byte %110111010 '17500
       byte %110111011 '17600
       byte %110111001 '17700
       byte %110101001 '17800
       byte %110101011 '17900
       byte %110101010 '18000
       byte %110101110 '18100
       byte %110101100 '18200
       byte %110100100 '18300
       byte %110100110 '18400
       byte %110100010 '18500
       byte %110100011 '18600
       byte %110100001 '18700
       byte %111100001 '18800
       byte %111100011 '18900
       byte %111100010 '19000
       byte %111100110 '19100
       byte %111100100 '19200
       byte %111101100 '19300
       byte %111101110 '19400
       byte %111101010 '19500
       byte %111101011 '19600
       byte %111101001 '19700
       byte %111111001 '19800
       byte %111111011 '19900
       byte %111111010 '20000
       byte %111111110 '20100
       byte %111111100 '20200
       byte %111110100 '20300
       byte %111110110 '20400
       byte %111110010 '20500
       byte %111110011 '20600
       byte %111110001 '20700
       byte %111010001 '20800
       byte %111010011 '20900
       byte %111010010 '21000
       byte %111010110 '21100
       byte %111010100 '21200
       byte %111011100 '21300
       byte %111011110 '21400
       byte %111011010 '21500
       byte %111011011 '21600
       byte %111011001 '21700
       byte %111001001 '21800
       byte %111001011 '21900
       byte %111001010 '22000
       byte %111001110 '22100
       byte %111001100 '22200
       byte %111000100 '22300
       byte %111000110 '22400
       byte %111000010 '22500
       byte %111000011 '22600
       byte %111000001 '22700
       byte %101000001 '22800
       byte %101000011 '22900
       byte %101000010 '23000
       byte %101000110 '23100
       byte %101000100 '23200
       byte %101001100 '23300
       byte %101001110 '23400
       byte %101001010 '23500
       byte %101001011 '23600
       byte %101001001 '23700
       byte %101011001 '23800
       byte %101011011 '23900
       byte %101011010 '24000
       byte %101011110 '24100
       byte %101011100 '24200
       byte %101010100 '24300
       byte %101010110 '24400
       byte %101010010 '24500
       byte %101010011 '24600
       byte %101010001 '24700
       byte %101110001 '24800
       byte %101110011 '24900
       byte %101110010 '25000
       byte %101110110 '25100
       byte %101110100 '25200
       byte %101111100 '25300
       byte %101111110 '25400
       byte %101111010 '25500
       byte %101111011 '25600
       byte %101111001 '25700
       byte %101101001 '25800
       byte %101101011 '25900
       byte %101101010 '26000
       byte %101101110 '26100
       byte %101101100 '26200
       byte %101100100 '26300
       byte %101100110 '26400
       byte %101100010 '26500
       byte %101100011 '26600
       byte %101100001 '26700
       byte %100100001 '26800
       byte %100100011 '26900
       byte %100100010 '27000
       byte %100100110 '27100
       byte %100100100 '27200
       byte %100101100 '27300
       byte %100101110 '27400
       byte %100101010 '27500
       byte %100101011 '27600
       byte %100101001 '27700
       byte %100111001 '27800
       byte %100111011 '27900
       byte %100111010 '28000
       byte %100111110 '28100
       byte %100111100 '28200
       byte %100110100 '28300
       byte %100110110 '28400
       byte %100110010 '28500
       byte %100110011 '28600
       byte %100110001 '28700
       byte %100010001 '28800
       byte %100010011 '28900
       byte %100010010 '29000
       byte %100010110 '29100
       byte %100010100 '29200
       byte %100011100 '29300
       byte %100011110 '29400
       byte %100011010 '29500
       byte %100011011 '29600
       byte %100011001 '29700
       byte %100001001 '29800
       byte %100001011 '29900
       byte %100001010 '30000

ABCODE byte %000000 ' -1200
       byte %000001 ' -700
       byte %000011 ' -200 
       byte %000010 ' 300
       byte %000110 ' 800
       byte %000111 ' 1300
       byte %000101 ' 1800
       byte %000100 ' 2300
       byte %001100 ' 2800
       byte %001101 ' 3300
       byte %001111 ' 3800
       byte %001110 ' 4300
       byte %001010 ' 4800
       byte %001011 ' 5300
       byte %001001 ' 5800
       byte %001000 ' 6300
       byte %011000 ' 6800
       byte %011001 ' 7300
       byte %011011 ' 7800
       byte %011010 ' 8300
       byte %011110 ' 8800
       byte %011111 ' 9300
       byte %011101 ' 9800
       byte %011100 ' 10300
       byte %010100 ' 10800
       byte %010101 ' 11300
       byte %010111 ' 11800
       byte %010110 ' 12300
       byte %010010 ' 12800
       byte %010011 ' 13300
       byte %010001 ' 13800
       byte %010000 ' 14300
       byte %110000 ' 14800
       byte %110001 ' 15300
       byte %110011 ' 15800
       byte %110010 ' 16300
       byte %110110 ' 16800
       byte %110111 ' 17300
       byte %110101 ' 17800
       byte %110100 ' 18300
       byte %111100 ' 18800
       byte %111101 ' 19300
       byte %111111 ' 19800
       byte %111110 ' 20300
       byte %111010 ' 20800
       byte %111011 ' 21300
       byte %111001 ' 21800
       byte %111000 ' 22300 
       byte %101000 ' 22800 
       byte %101001 ' 23300
       byte %101011 ' 23800
       byte %101010 ' 24300
       byte %101110 ' 24800
       byte %101111 ' 25300
       byte %101101 ' 25800
       byte %101100 ' 26300
       byte %100100 ' 26800
       byte %100101 ' 27300
       byte %100111 ' 27800
       byte %100110 ' 28300 
       byte %100010 ' 28800
       byte %100011 ' 29300
       byte %100001 ' 29800
       byte %100000 ' 30300

CCODE  byte %001 ' -200 
       byte %011 ' -100
       byte %010 ' 0
       byte %110 ' 100
       byte %100 ' 200
       byte %110 ' 300
       byte %010 ' 400
